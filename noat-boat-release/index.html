<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Noat Boat Release - Noat Boat</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: system-ui, -apple-system, sans-serif; background: #f2f2f2; color: #111; height: 100vh; display: flex; flex-direction: column; }
    .topbar { display: flex; align-items: center; padding: 10px 14px; border-bottom: 1px solid #d9d9d9; background: #ffffff; gap: 12px; }
    .back-btn { padding: 6px 12px; border: 1px solid #d9d9d9; background: #ffffff; border-radius: 6px; cursor: pointer; font-size: 13px; color: #111; text-decoration: none; }
    .title { font-size: 16px; font-weight: 700; font-family: monospace; flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .save-status { font-size: 12px; color: #666; font-family: monospace; }
    .main { display: flex; flex: 1; overflow: hidden; gap: 16px; padding: 14px; min-height: 0; }
    .editor-pane { flex: 1; display: flex; flex-direction: column; min-width: 200px; min-height: 0; }
    textarea { flex: 1; border: 1px solid #d9d9d9; border-radius: 12px; resize: none; padding: 14px; font-size: 14px; line-height: 1.55; font-family: monospace; background: #fff; color: #111; outline: none; }
    .canvas-pane { flex: 1; display: flex; flex-direction: column; min-width: 200px; min-height: 0; border: 1px solid #d9d9d9; border-radius: 12px; overflow: hidden; background: #fff; }
    .canvas-toolbar { display: flex; gap: 6px; padding: 8px 10px; border-bottom: 1px solid #d9d9d9; background: #ffffff; flex-shrink: 0; }
    .btn { padding: 5px 10px; border: 1px solid #d9d9d9; background: #ffffff; border-radius: 6px; cursor: pointer; font-size: 12px; color: #111; }
    .btn.active { background: #eef5ff; border-color: #c9dcff; }
    #canvasContainer { flex: 1; position: relative; overflow: hidden; min-height: 0; display: flex; align-items: center; justify-content: center; }
    .canvas-wrapper { transform-origin: center center; display: inline-block; }
    .audio-player { padding: 10px; border-top: 1px solid #d9d9d9; display: none; flex-shrink: 0; }
    .audio-player audio { width: 100%; }
    @media (max-width: 768px) { .main { flex-direction: column; } .editor-pane, .canvas-pane { flex: none; height: 45vh; } }
  </style>
</head>
<body>
  <div class="topbar">
    <a href="../index.html" class="back-btn">Back</a>
    <div class="title">Noat Boat Release</div>
    <div class="save-status" id="saveStatus"></div>
  </div>
  <div class="main">
    <div class="editor-pane">
      <textarea id="editor" spellcheck="false">Yeah this is Noat Boat

Nothing Fancy just a little thing-

Released Noat Boat 1.0 on 12/16/25 the same day as our Christmas dinner here in Portugal.

Need to re-release it on Steam 

Mac + Pc + Linux

Thinking about Note export-

For human consumption as well as LLM

Human consumption could be sequence of images?

LLM consumption could be text + images to describe a thing to build

I&#39;m writing in here
	* now I can tab sick
	* still works

So lets see if this saving works?


</textarea>
    </div>
    <div class="canvas-pane" id="canvasPane">
      <div class="canvas-toolbar">
        <button id="selectBtn" class="btn active">Select</button>
        <button id="drawBtn" class="btn">Draw</button>
      </div>
      <div id="canvasContainer">
        <div class="canvas-wrapper" id="canvasWrapper">
          <canvas id="fabricCanvas"></canvas>
        </div>
      </div>
      <div class="audio-player"><audio controls loop src=""></audio></div>
    </div>
  </div>
  <script>
    (function() {
      var STORAGE_KEY = 'noatboat_' + "noat-boat-release";
      var canvasJson = "{\"version\":\"5.3.0\",\"objects\":[{\"type\":\"path\",\"version\":\"5.3.0\",\"originX\":\"left\",\"originY\":\"top\",\"left\":-84.68,\"top\":185.43,\"width\":845.01,\"height\":1114.34,\"fill\":null,\"stroke\":\"#000000\",\"strokeWidth\":3,\"strokeDashArray\":null,\"strokeLineCap\":\"round\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"round\",\"strokeUniform\":false,\"strokeMiterLimit\":10,\"scaleX\":1,\"scaleY\":1,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"skewX\":0,\"skewY\":0,\"selectable\":true,\"hasControls\":true,\"path\":[[\"M\",761.8277136491942,186.92866566170662],[\"Q\",761.8247136491941,186.9316656617066,756.8231973312805,186.9316656617066],[\"Q\",751.821681013367,186.9316656617066,737.8174353232091,192.93348502743365],[\"Q\",723.8131896330511,198.9353043931607,696.805001516318,217.94106571796297],[\"Q\",669.7968133995848,236.94682704276525,613.7798306389532,282.9607755133392],[\"Q\",557.7628478783214,328.9747239839131,482.7401031096182,395.99504023453164],[\"Q\",407.7173583409149,463.0153564851502,331.69431030862904,536.0374921014958],[\"Q\",255.67126227634313,609.0596277178414,185.65003382555346,681.0814601065658],[\"Q\",115.62880537476381,753.1032924952902,67.61424872279376,809.1202732420759],[\"Q\",19.59969207082371,865.1372539888616,-11.409709100240281,909.1505960041932],[\"Q\",-42.41911027130427,953.1639380195247,-58.42396248862762,989.174854213887],[\"Q\",-74.42881470595097,1025.1857704082493,-79.43033102386451,1052.193957554021],[\"Q\",-84.43184734177807,1079.2021446997926,-79.43033102386451,1107.2106350731854],[\"Q\",-74.42881470595097,1135.2191254465781,-58.42396248862762,1164.2279190475922],[\"Q\",-42.41911027130427,1193.2367126486063,-16.411225418153826,1216.2436868838931],[\"Q\",9.596659434996617,1239.25066111918,38.60545407889519,1256.2558159887399],[\"Q\",67.61424872279376,1273.2609708583,89.62092052161337,1282.2636999068905],[\"Q\",111.62759232043298,1291.2664289554812,127.63244453775633,1294.2673386383447],[\"Q\",143.6372967550797,1297.2682483212081,160.64245223598573,1299.2688547764506],[\"Q\",177.6476077168918,1301.2694612316927,192.65215667063245,1301.2694612316927],[\"Q\",207.65670562437307,1301.2694612316927,219.6603447873656,1301.2694612316927],[\"Q\",231.6639839503581,1301.2694612316927,247.66883616768146,1301.2694612316927],[\"Q\",263.6736883850048,1301.2694612316927,285.6803601838244,1300.2691580040716],[\"Q\",307.687031982644,1299.2688547764506,334.69522009937714,1298.2685515488292],[\"Q\",361.70340821611035,1297.2682483212081,393.713112650757,1297.2682483212081],[\"Q\",425.72281708540373,1297.2682483212081,457.73252152005045,1297.2682483212081],[\"Q\",489.7422259546971,1297.2682483212081,520.7516271257612,1296.267945093587],[\"Q\",551.7610282968251,1295.2676418659657,574.7680033592274,1293.2670354107236],[\"Q\",597.7749784216297,1291.2664289554812,614.7801339025358,1288.2655192726174],[\"Q\",631.7852893834419,1285.264609589754,643.7889285464344,1282.2636999068905],[\"Q\",655.7925677094269,1279.262790224027,660.7940840273404,1277.2621837687848],[\"Q\",665.795600345254,1275.2615773135424,667.7962068724194,1269.2597579478152],[\"Q\",669.7968133995848,1263.2579385820882,669.7968133995848,1258.2564224439825],[\"Q\",669.7968133995848,1253.2549063058766,669.7968133995848,1249.253693395392],[\"Q\",669.7968133995848,1245.2524804849072,669.7968133995848,1229.2476288429684],[\"Q\",669.7968133995848,1213.2427772010296,669.7968133995848,1179.23246746191],[\"Q\",669.7968133995848,1145.22215772279,669.7968133995848,1072.2000221064443],[\"Q\",669.7968133995848,999.1778864900987,669.7968133995848,891.145137907012],[\"Q\",669.7968133995848,783.1123893239254,671.7974199267503,695.0857052932622],[\"Q\",673.7980264539157,607.0590212625991,679.799846035412,556.0435566539193],[\"Q\",685.8016656169082,505.0280920452395,692.8037884619871,469.01717585087727],[\"Q\",699.8059113070661,433.00625965651506,704.8074276249797,411.99989187647043],[\"Q\",709.8089439428932,390.9935240964258,712.8098537336414,383.9914015030776],[\"Q\",715.8107635243895,376.9892789097294,715.8107635243895,374.9886724544871],[\"Q\",715.8107635243895,372.9880659992447,714.8104602608067,370.9874595440024],[\"Q\",713.810156997224,368.98685308876003,707.8083374157277,362.985033723033],[\"Q\",701.8065178342315,356.98321435730594,690.8031819348216,346.9801820810942],[\"Q\",679.7998460354119,336.9771498048825,667.7962068724194,328.9747239839131],[\"Q\",655.7925677094269,320.97229816294373,644.7892318100171,315.97078202483783],[\"Q\",633.7858959106072,310.969265886732,624.7831665383628,306.96805297624735],[\"Q\",615.7804371661185,302.96684006576265,607.7780110574569,298.96562715527796],[\"Q\",599.7755849487952,294.96441424479326,593.7737653672989,292.9638077895509],[\"Q\",587.7719457858026,290.96320133430856,584.7710359950545,289.96289810668736],[\"Q\",581.7701262043064,288.9625948790662,580.7698229407237,289.96289810668736],[\"L\",579.7665196771409,290.96620133430855]]},{\"type\":\"path\",\"version\":\"5.3.0\",\"originX\":\"left\",\"originY\":\"top\",\"left\":290.18,\"top\":571.55,\"width\":96.03,\"height\":176.06,\"fill\":null,\"stroke\":\"#000000\",\"strokeWidth\":3,\"strokeDashArray\":null,\"strokeLineCap\":\"round\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"round\",\"strokeUniform\":false,\"strokeMiterLimit\":10,\"scaleX\":1,\"scaleY\":1,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"skewX\":0,\"skewY\":0,\"selectable\":true,\"hasControls\":true,\"path\":[[\"M\",353.7039821074486,573.0457115234792],[\"Q\",353.7009821074486,573.0487115234793,352.70067884386594,573.0487115234793],[\"Q\",351.7003755802832,573.0487115234793,349.6997690531178,576.0496212063427],[\"Q\",347.6991625259524,579.0505308892062,343.69794947162154,585.0523502549333],[\"Q\",339.6967364172907,591.0541696206603,334.69522009937714,601.0572018968721],[\"Q\",329.6937037814636,611.0602341730838,324.6921874635501,622.0635696769167],[\"Q\",319.69067114563654,633.0669051807496,315.6894580913057,644.0702406845825],[\"Q\",311.6882450369749,655.0735761884154,308.6873352462267,666.0769116922482],[\"Q\",305.68642545547857,677.0802471960811,305.68642545547857,689.0838859275352],[\"Q\",305.68642545547857,701.0875246589893,305.68642545547857,710.0902537075799],[\"Q\",305.68642545547857,719.0929827561704,305.68642545547857,725.0948021218974],[\"Q\",305.68642545547857,731.0966214876245,307.687031982644,735.0978343981092],[\"Q\",309.6876385098094,739.0990473085939,313.68885156414024,742.0999569914574],[\"Q\",317.6900646184711,745.1008666743209,323.6918841999674,747.1014731295631],[\"Q\",329.6937037814636,749.1020795848056,335.6955233629599,749.1020795848056],[\"Q\",341.6973429444561,749.1020795848056,346.69885926236964,749.1020795848056],[\"Q\",351.7003755802832,749.1020795848056,356.7018918981968,748.1017763571845],[\"Q\",361.70340821611035,747.1014731295633,366.7049245340239,743.1002602190786],[\"Q\",371.70644085193743,739.0990473085939,374.7073506426856,735.0978343981092],[\"Q\",377.7082604334337,731.0966214876245,379.7088669605991,727.0954085771398],[\"Q\",381.7094734877645,723.0941956666551,383.71008001492993,718.0926795285493],[\"Q\",385.71068654209535,713.0911633904434,386.7109898056781,709.0899504799587],[\"Q\",387.71129306926076,705.088737569474,387.71129306926076,699.086918203747],[\"Q\",387.71129306926076,693.0850988380199,387.71129306926076,688.0835826999141],[\"Q\",387.71129306926076,683.0820665618082,383.71008001492993,676.0799439684599],[\"Q\",379.7088669605991,669.0778213751117,374.7073506426856,661.0753955541423],[\"Q\",369.705834324772,653.072969733173,362.703711479693,645.0705439122037],[\"Q\",355.70158863461404,637.0681180912343,346.69885926236964,630.065995497886],[\"Q\",337.6961298901253,623.0638729045378,329.6937037814636,618.062356766432],[\"Q\",321.69127767280196,613.0608406283261,314.689154827723,610.0599309454626],[\"Q\",307.687031982644,607.0590212625991,302.6855156647305,606.0587180349779],[\"Q\",297.6839993468169,605.0584148073567,294.6830895560688,605.0584148073567],[\"L\",291.67917976532067,605.0584148073567]]},{\"type\":\"path\",\"version\":\"5.3.0\",\"originX\":\"left\",\"originY\":\"top\",\"left\":460.23,\"top\":607.56,\"width\":136.04,\"height\":94.03,\"fill\":null,\"stroke\":\"#000000\",\"strokeWidth\":3,\"strokeDashArray\":null,\"strokeLineCap\":\"round\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"round\",\"strokeUniform\":false,\"strokeMiterLimit\":10,\"scaleX\":1,\"scaleY\":1,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"skewX\":0,\"skewY\":0,\"selectable\":true,\"hasControls\":true,\"path\":[[\"M\",563.7676674598176,609.0596277178414],[\"Q\",563.7646674598176,609.0596277178414,563.7646674598176,610.0599309454626],[\"Q\",563.7646674598176,611.0602341730838,562.764364196235,611.0602341730838],[\"Q\",561.7640609326522,611.0602341730838,558.763151141904,611.0602341730838],[\"Q\",555.7622413511559,611.0602341730838,548.760118506077,613.0608406283261],[\"Q\",541.7579956609981,615.0614470835684,531.7549630251709,620.0629632216743],[\"Q\",521.7519303893438,625.0644793597802,509.7482912263513,631.0662987255073],[\"Q\",497.7446520633588,637.0681180912343,488.7419226911144,642.0696342293402],[\"Q\",479.73919331887004,647.071150367446,474.7376770009565,650.0720600503095],[\"Q\",469.73616068304295,653.072969733173,466.73525089229486,656.0738794160366],[\"Q\",463.7343411015467,659.0747890989,462.73403783796397,661.0753955541425],[\"Q\",461.73373457438123,663.0760020093848,461.73373457438123,665.076608464627],[\"Q\",461.73373457438123,667.0772149198694,461.73373457438123,669.0778213751119],[\"Q\",461.73373457438123,671.0784278303541,462.73403783796397,674.0793375132176],[\"Q\",463.7343411015467,677.0802471960811,467.73555415587754,681.0814601065658],[\"Q\",471.73676721020837,685.0826730170505,477.7385867917046,688.083582699914],[\"Q\",483.74040637320087,691.0844923827775,490.74252921827986,694.0854020656411],[\"Q\",497.7446520633588,697.0863117485046,505.74707817202045,699.086918203747],[\"Q\",513.7495042806821,701.0875246589893,522.7522336529265,702.0878278866105],[\"Q\",531.7549630251709,703.0881311142316,540.7576923974153,703.0881311142316],[\"Q\",549.7604217696597,703.0881311142316,558.763151141904,702.0878278866105],[\"Q\",567.7658805141484,701.0875246589893,574.7680033592274,699.086918203747],[\"Q\",581.7701262043064,697.0863117485046,585.7713392586372,695.0857052932622],[\"Q\",589.7725523129681,693.0850988380199,592.7734621037162,690.0841891551564],[\"Q\",595.7743718944644,687.0832794722929,596.7746751580471,686.0829762446717],[\"Q\",597.7749784216297,685.0826730170505,597.7749784216297,683.0820665618082],[\"Q\",597.7749784216297,681.0814601065658,595.7743718944644,677.0802471960811],[\"Q\",593.7737653672989,673.0790342855964,589.7725523129681,669.0778213751117],[\"Q\",585.7713392586372,665.076608464627,579.769519677141,660.0750923265211],[\"Q\",573.7677000956447,655.0735761884154,568.7661837777312,652.0726665055519],[\"Q\",563.7646674598176,649.0717568226884,559.7634544054868,648.0714535950672],[\"Q\",555.7622413511559,647.071150367446,552.7613315604078,646.0708471398248],[\"L\",549.7574217696597,645.0675439122036]]},{\"type\":\"path\",\"version\":\"5.3.0\",\"originX\":\"left\",\"originY\":\"top\",\"left\":268.17,\"top\":801.62,\"width\":350.11,\"height\":286.09,\"fill\":null,\"stroke\":\"#000000\",\"strokeWidth\":3,\"strokeDashArray\":null,\"strokeLineCap\":\"round\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"round\",\"strokeUniform\":false,\"strokeMiterLimit\":10,\"scaleX\":1,\"scaleY\":1,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"skewX\":0,\"skewY\":0,\"selectable\":true,\"hasControls\":true,\"path\":[[\"M\",369.708834324772,839.129370070711],[\"Q\",369.705834324772,839.129370070711,368.7055310611893,839.129370070711],[\"Q\",367.7052277976066,839.129370070711,366.7049245340239,839.129370070711],[\"Q\",365.7046212704412,839.129370070711,363.70401474327576,839.129370070711],[\"Q\",361.70340821611035,839.129370070711,356.7018918981968,839.129370070711],[\"Q\",351.7003755802832,839.129370070711,346.69885926236964,839.129370070711],[\"Q\",341.6973429444561,839.129370070711,337.6961298901253,841.1299765259535],[\"Q\",333.69491683579446,843.1305829811957,329.6937037814636,847.1317958916804],[\"Q\",325.6924907271328,851.1330088021651,321.69127767280196,855.1342217126498],[\"Q\",317.6900646184711,859.1354346231345,314.689154827723,866.1375572164827],[\"Q\",311.6882450369749,873.1396798098309,310.68794177339214,881.1421056308003],[\"Q\",309.6876385098094,889.1445314517697,309.6876385098094,899.1475637279814],[\"Q\",309.6876385098094,909.1505960041932,309.6876385098094,922.1545379632685],[\"Q\",309.6876385098094,935.1584799223436,310.68794177339214,949.1627251090401],[\"Q\",311.6882450369749,963.1669702957365,314.689154827723,979.1718219376753],[\"Q\",317.6900646184711,995.176673579614,322.69158093638464,1007.1803123110681],[\"Q\",327.6930972542982,1019.1839510425222,333.69491683579446,1027.1863768634914],[\"Q\",339.6967364172907,1035.1888026844608,347.6991625259524,1044.1915317330513],[\"Q\",355.70158863461404,1053.194260781642,366.70492453402386,1060.19638337499],[\"Q\",377.7082604334337,1067.1985059683384,387.71129306926076,1073.2003253340654],[\"Q\",397.71432570508784,1079.2021446997926,407.717358340915,1081.202751155035],[\"Q\",417.72039097674207,1083.2033576102772,427.72342361256915,1085.2039640655196],[\"Q\",437.72645624839623,1087.204570520762,449.73009541138873,1088.204873748383],[\"Q\",461.73373457438123,1089.2051769760042,474.73767700095647,1089.2051769760042],[\"Q\",487.7416194275317,1089.2051769760042,498.7449553269415,1087.204570520762],[\"Q\",509.7482912263513,1085.2039640655196,522.7522336529265,1080.2024479274137],[\"Q\",535.7561760795018,1075.2009317893078,548.760118506077,1069.1991124235808],[\"Q\",561.7640609326522,1063.1972930578538,570.7667903048966,1056.1951704645057],[\"Q\",579.7695196771409,1049.1930478711574,586.77164252222,1041.190622050188],[\"Q\",593.7737653672989,1033.1881962292186,600.7758882123778,1023.1851639530068],[\"Q\",607.7780110574569,1013.1821316767952,611.7792241117877,1001.1784929453411],[\"Q\",615.7804371661185,989.174854213887,617.7810436932839,976.1709122548118],[\"Q\",619.7816502204494,963.1669702957365,619.7816502204494,950.1630283366612],[\"Q\",619.7816502204494,937.159086377586,616.7807404297012,923.1548411908896],[\"Q\",613.7798306389531,909.1505960041932,607.7780110574568,897.1469572727391],[\"Q\",601.7761914759606,885.143318541285,591.7731588401334,875.1402862650733],[\"Q\",581.7701262043064,865.1372539888616,569.7664870413139,855.1342217126498],[\"Q\",557.7628478783214,845.1311894364381,543.7586021881634,838.12906684309],[\"Q\",529.7543564980054,831.1269442497418,503.74647164485503,822.1242152011512],[\"Q\",477.7385867917046,813.1214861525606,461.7337345743813,810.1205764696971],[\"Q\",445.7288823570579,807.1196667868336,428.72372687615183,806.1193635592124],[\"Q\",411.71857139524576,805.1190603315912,393.713112650757,804.11875710397],[\"Q\",375.70765390626826,803.1184538763489,356.7018918981968,803.1184538763489],[\"Q\",337.6961298901253,803.1184538763489,323.6918841999674,803.1184538763489],[\"Q\",309.6876385098094,803.1184538763489,299.6846058739823,804.11875710397],[\"Q\",289.68157323815524,805.1190603315912,283.679753656659,807.1196667868335],[\"Q\",277.67793407516274,809.1202732420759,274.67702428441464,810.1205764696971],[\"Q\",271.6761144936665,811.1208796973183,270.6758112300838,813.1214861525607],[\"L\",269.6725079665011,815.125092607803]]}]}";
      var canvasImage = "canvas.png";
      var fallbackImage = null;
      var fabricCanvas = null, saveTimer = null;
      var originalW = 600, originalH = 800; // defaults
      var editor = document.getElementById('editor');
      var saveStatus = document.getElementById('saveStatus');
      
      try { var saved = localStorage.getItem(STORAGE_KEY); if (saved) { var data = JSON.parse(saved); if (data.content) editor.value = data.content; } } catch(e){}
      
      function scheduleSave() {
        if (saveTimer) clearTimeout(saveTimer);
        saveTimer = setTimeout(function() {
          try { localStorage.setItem(STORAGE_KEY, JSON.stringify({ content: editor.value })); saveStatus.textContent = 'saved'; } catch(e){}
        }, 1000);
      }
      editor.addEventListener('input', function() { saveStatus.textContent = 'modified'; scheduleSave(); });
      
      function scaleCanvasToFit() {
        var container = document.getElementById('canvasContainer');
        var wrapper = document.getElementById('canvasWrapper');
        var rect = container.getBoundingClientRect();
        var containerW = rect.width - 20;
        var containerH = rect.height - 20;
        
        if (containerW <= 0 || containerH <= 0) return;
        
        var scaleX = containerW / originalW;
        var scaleY = containerH / originalH;
        var scale = Math.min(scaleX, scaleY, 1); // never scale up beyond 1
        
        wrapper.style.transform = 'scale(' + scale + ')';
      }
      
      function initCanvas() {
        // Get original dimensions from JSON if available
        if (canvasJson) {
          originalW = canvasJson.width || 600;
          originalH = canvasJson.height || 800;
        }
        
        var el = document.getElementById('fabricCanvas');
        el.width = originalW;
        el.height = originalH;
        
        fabricCanvas = new fabric.Canvas('fabricCanvas', { 
          width: originalW, 
          height: originalH, 
          backgroundColor: null 
        });
        fabricCanvas.freeDrawingBrush.width = 3;
        fabricCanvas.freeDrawingBrush.color = '#000000';
        
        if (canvasJson) {
          fabricCanvas.loadFromJSON(canvasJson, function() {
            fabricCanvas.renderAll();
            scaleCanvasToFit();
          });
        } else if (canvasImage || fallbackImage) {
          fabric.Image.fromURL(canvasImage || fallbackImage, function(img) {
            if (!img) return;
            img.set({ left: 0, top: 0, selectable: true });
            fabricCanvas.add(img);
            fabricCanvas.renderAll();
            scaleCanvasToFit();
          }, null, { crossOrigin: 'anonymous' });
        } else {
          scaleCanvasToFit();
        }
      }
      
      document.getElementById('selectBtn').onclick = function() { 
        if(fabricCanvas) { 
          fabricCanvas.isDrawingMode = false; 
          this.classList.add('active'); 
          document.getElementById('drawBtn').classList.remove('active'); 
        } 
      };
      document.getElementById('drawBtn').onclick = function() { 
        if(fabricCanvas) { 
          fabricCanvas.isDrawingMode = true; 
          this.classList.add('active'); 
          document.getElementById('selectBtn').classList.remove('active'); 
        } 
      };
      
      setTimeout(initCanvas, 150);
      
      window.addEventListener('resize', function() {
        scaleCanvasToFit();
      });
    })();
  </script>
</body>
</html>